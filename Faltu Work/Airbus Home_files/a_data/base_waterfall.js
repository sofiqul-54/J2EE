/**
 * Stackla is made available under a commercial licence
 * and is subject to Stackla's Terms of Service.
 *
 * Refer to https://stackla.com/terms-of-service/ 
 * or contact support@stackla.com for further clarification.
 *
 * Built on 2018-05-18 12:05:03
 */
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="https://staging-assetscdn.stackla.com/media/js/dist/",b(0)}([function(a,b){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};window.Widget=function(a){function b(a,b){return _.includes(a,b)}function d(a,b){_.each(a,b)}function e(){if(0===Ub.length)return!0;var b,c=a(".tile").length,d=Ub.length;return b=Cb?Qb*Xa:yb,Stackla.log("needApiCall: (memoryCount - domCount) > numItemsToLoad, "+(d-c)+" > "+b),d-c<=b}function f(a,b){Ub=_.reject(Ub,v),b?_.each(a,function(a){_.includes(Vb,a._id.$id)||(Vb.push(a._id.$id),Ub.push(a))}):_.each(a,function(a){_.includes(Vb,a._id.$id)||(Vb.push(a._id.$id),Ub.splice(0,0,a))}),Wb=_.sortByOrder(Wb,["current_pinned_position","source_created_at"],["asc","asc"]);var c=I();_.each(Wb,function(a){var b=a.current_pinned_position,d=!!a.current_pinned_always;b<=c?Ub.splice(parseInt(b)-1,0,a):d&&Ub.splice(parseInt(b)-1,0,a)})}function g(b,c){var d;if(b.length){Stackla.log("[inside] appendTiles() is executed"),window.fluidWidgetCustomCallbacks.onBeforeRenderTiles(c,b);for(d in b)b.hasOwnProperty(d)&&F(b[d],-1);window.fluidWidgetCustomCallbacks.onCompleteRenderTiles(a(c),b),a(document).trigger("tilesAppend",[b])}}function h(a,b){if("object"===c(a.filters_pinned_on)){for(var d in a.filters_pinned_on)if(a.filters_pinned_on[d].filter_id===b)return a.filters_pinned_on[d];for(var d in a.filters_pinned_on)if(0===a.filters_pinned_on[d].filter_id)return a.filters_pinned_on[d]}return!1}function i(a){var b=parseInt(wa);if(a&&"object"==("undefined"==typeof a?"undefined":c(a))&&a.length)for(var d in a)if(a[d].is_pin&&"undefined"!=typeof a[d].filters_pinned_on){var e=!1;e=h(a[d],b),e!==!1&&(a[d].current_pinned_position=e.position,a[d].current_pinned_always=e.always,Wb.push(a[d]),Vb.push(a[d]._id.$id))}Wb.sort(function(a,b){return a.current_pinned_position-b.current_pinned_position})}function j(){Stackla.log("[inside] loadInitData() call start"),Ab=!0,Tb=!0,Ta=new Date;var b;b=ya?a.Deferred().resolve([]):a.ajax({url:l(ta,ua,va,ra,Aa,wa),dataType:"json"}),a.when(b,a.ajax({url:G(ma,ta,ua,va,zb,ra,wa,Aa,Lb),dataType:"json"})).done(function(a,b){Ua=new Date,Stackla.log("[inside] loadInitData() call finished");var c=a[0],d=b[0];i(c),f(d,!0),d.length&&("undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",ma]),zb+=1),J(),L(),ob(),cc=!0,P(),Ab=!1,Tb=!1})}function k(b){Stackla.log("[inside] Pin API call start"),a.ajax({url:l(ta,ua,va,ra,Aa,wa),type:"get",dataType:"json",success:function(a){Stackla.log("[inside] Pin API call end"),i(a),b()}})}function l(a,b,c,d,e,f){var g="";return g=c?"?draft_id="+c+"&":b?"?wid="+b+"&":"/"+a+"?","/widget/pins"+g+"&ttl="+d+"&domain="+e+"&filter_id="+f}function m(a,b,c){for(var d in Ub)Ub[d]._id.$id==a&&(Ub[d][b]=c)}function n(b,c,d){var e=a("#"+b).find(".tile-interaction-vote");e.length&&(c?e.addClass("on"):e.removeClass("on"),e.find("span").text(d))}function o(b,c){var d=a("#"+b),e=a('<div class="competition-vote-message">'+stacklaString(c).escapeHTML().s+"</div>"),f=a('<div class="competition-vote-message-overlay"></div>'),g=a('<div class="competition-vote-message-wrapper"></div>');d.append(g.append(f).append(e)),setTimeout(function(){g.remove()},3e3)}function p(a){return"undefined"!=typeof a.entitlements&&a.entitlements?a.entitlements:a.entities}function q(a){return"undefined"!=typeof a.in_reply_to_entitlements&&a.in_reply_to_entitlements?a.in_reply_to_entitlements:a.in_reply_to_entities}function r(b,d,e,f){if(("stackla"===b||"sta_feed"===b)&&"undefined"!=typeof f&&f&&"html"===f)return stacklaXSSFilter(d);if("twitter"==b)return e?(d=twttr.txt.autoLink(d,{urlEntities:e,targetBlank:!0}),d=twemoji.parse(d,{className:"tile-emoji"})):d;var g=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,h=a.trim(d);if(h){var i=/(<([^>]+)>)/gi;if(h=h.replace(i,""),h=h.replace(/^[\n\r]*/,""),h=h.replace(/[\n\r]*$/,""),h=h.replace(g,"<a href='$1' target='_new'>$1</a>"),h=h.replace(/[\n]+/g,"<br />"),"facebook"===b){var j=/@\[[^\]]*\]/g,k=h.match(j);if(k&&"object"==("undefined"==typeof k?"undefined":c(k))&&k.length){var l=/@\[([^:\]]*):([^:\]]*):([^:\]]*)\]/;for(var m in k){var n=k[m].replace(l,"<a href='http://www.facebook.com/$1' target='_new'>$3</a>");h=h.replace(k[m],n)}}}return h=twemoji.parse(h,{className:"tile-emoji"})}return""}function s(a,b){if("undefined"!=typeof httpsRules&&httpsRules&&"undefined"!=typeof httpsRules[b]&&"undefined"!=typeof httpsRules[b].rules)for(var c in httpsRules[b].rules)try{var d=httpsRules[b].rules[c],e=new RegExp(d.from);if(e.test(a))return a.replace(e,d.to)}catch(a){}return a}function t(a,b){return s(a,b)}function u(a,b){return s(a,b)}function v(a){if(Wb.length)for(var b in Wb)if(Wb[b]._id.$id==a._id.$id)return!0;return!1}function w(a){var b,c=a.tags||[],d="1"===Ja.show_claim_button||Ja.show_claim_button===!0;return!(!(Ha&&Ja&&_.include(["twitter","instagram"],a.source)&&!_.isUndefined(a.claimed)&&d)||a.page_post)&&(b=Ja.show_claim_button_on_tags||[],!b.length||_.intersection(b,c).length>=1)}function x(a,b,c){var d=decorateTileData(a,b,c);return d.play_inline_youtube=a.is_youtube&&"[NONE]"===Ea.click_through_url,d}function y(b){var c,d,e=x(b,$a,oa);Stackla.log("[inside] createTile() is executed"),y.template||(y.template=a("#tpl-tile").html()),c=y.template,d=a(Mustache.render(c,e)),$a.show_sharing&&d.find(".tile-interactions").append($b(b)),"stackla"===b.source&&"official"===b.type&&mb(d,b);var f=window.fluidWidgetCustomCallbacks.onCompleteJsonToHtml(d,e);return f}function z(){if(Fb){var a=getUrlVars();if("undefined"!=typeof a.data_user_id&&a.data_user_id&&"undefined"!=typeof a.data_user_hash&&a.data_user_hash){var b="";return"undefined"!=typeof a.data_user_name&&a.data_user_name&&(b=a.data_user_name),"data_user_id="+a.data_user_id+"&data_user_hash="+a.data_user_hash+"&data_user_name="+b}}return""}function A(a,b,c){var d=[];d.push("widget_id="+ta),d.push("filter_id="+wa),d.push("source="+a),d.push("source_user_id="+b),d.push("tile_id="+c);var e=z();return e&&d.push(e),"undefined"!=typeof Ja&&Ja&&Ja.terms_and_conditions&&d.push("tcurl="+encodeURIComponent(Ja.terms_and_conditions)),"undefined"!=typeof Ja&&Ja&&Ja.show_content_toggle&&d.push("show_content_toggle=1"),"https://"+Ka+"/claim/start?"+d.join("&")}function B(a,b,c){ha("openclaimedlightbox",{url:A(a,b,c)})}function C(b){var c=a(b).closest(".tile"),d=c.attr("id"),e=c.attr("network"),f=c.attr("identity"),g=a(b).naturalWidth(),h=a(b).naturalHeight(),i=!1;if(g<=30&&h<=30&&(i=!0),"youtube"===e&&g<=48&&h<=48&&(i=!0),i){a(b).css("visibility","hidden");var j=e+f,k=a.cookie("broken_avatar"),l=k?k.split(","):[];a(b).hide(),a.inArray(j,l)===-1&&(l.push(j),a.cookie("broken_avatar",l.join(","),{expires:365,path:"/"}),a.inArray(e,["twitter","facebook","flickr","gplus","youtube"])+1&&a.get("/widget/update_avatar/"+ta+"?tile_id="+d))}else a(b).parents(".tile-avatar-wrapper").find(".tile-avatar-placeholder").hide()}function D(b,c){var d=_.find(Ub,function(a){return b===a._id.$id});"expand"===c?a(document).trigger("tileExpand",[d]):a(document).trigger("tileClick",[d]),EventMixin.emit("tileExpand",[{expandType:c,tileData:d,widgetId:ta}],function(){ha("tileExpand",{expandType:c,tileData:d})})}function E(b,c){var d,e=b.attr("id");if(d=b.hasClass("tile-click-through")&&"tile"||b.hasClass("stack-click-through")&&"stack"||b.hasClass("original-click-through")&&"original"||b.hasClass("expand-click-through")&&"expand"||b.hasClass("no-click-through")&&"none"||b.hasClass("custom-click-through")&&"custom",b.filter(".tile:not(.no-click-through,.expand-click-through)").on("click",function(){var b,c=a(this);c.attr("data-href")&&(b=window.open(c.attr("data-href"),"_blank"),b.focus()),D(e,d)}),b.filter(".expand-click-through").on("click",function(){D(e,d),T(e,d)}),b.filter(".expand-click-through").find(".tile-interaction-comment .tile-interaction-link").on("click",function(b){var c=a(b.currentTarget).parents(".tile-interaction-comment")?"comment":null;D(e,d),T(e,"expanded-tile",c)}),c.play_inline_youtube){var f="//www.youtube.com/embed/"+c.embed_url+"?autoplay=1",g=b.find(".play-inline-youtube");g.on("click",function(){b.append('\t                <div class="tile-youtube-wrapper">\t                    <iframe type="text/html" src="'+f+'" frameborder="0" /> \t                    <div class="tile-youtube-close"><big>&times;</big> &nbsp; close</div> \t                </div>')}),b.on("click",".tile-youtube-close",function(){b.find(".tile-youtube-wrapper").remove()})}b.find("a").click(function(b){var c,d,f=a(b.currentTarget);if(b.stopPropagation(),d=_.find(Ub,function(a){return e===a._id.$id}),(f.hasClass("tile-user-top")||f.hasClass("tile-user-bottom"))&&(EventMixin.emit("userClick",[{shareNetwork:c,tileData:d,widgetId:ta}]),ha("userClick",{tileData:d})),f.hasClass("tile-share-button")){if(c=f.hasClass("facebook")&&"facebook"||f.hasClass("twitter")&&"twitter"||f.hasClass("pinterest")&&"pinterest"||f.hasClass("gplus")&&"gplus"||f.hasClass("linkedin")&&"linkedin"||f.hasClass("email")&&"email",!c)return;EventMixin.emit("shareClick",[{shareNetwork:c,tileData:d,widgetId:ta}]),ha("shareClick",{shareNetwork:c,tileData:d})}}),window.postRender&&window.postRender(b)}function F(b,c){var d=y(b);c===-1?la.append(d):0===c?la.prepend(d):a("#container .tile:eq("+(c-1).toString()+")").before(d),d.find(".tile-image-wrapper img").each(function(){a(this).imagesLoaded(function(){var a=this;setTimeout(function(){db(a)},200)})}),d.find(".avatar-profile-image").each(function(){a(this).imagesLoaded(function(){C(this)})}),d.find(".js-claim-tile").click(function(){var b=a(this).attr("data-source-user-id"),c=a(this).attr("data-source"),d=a(this).attr("data-tile-id");B(c,b,d)}),fb(d),d.find(".tile-caption, .tile-title").length>0&&(d.find(".tile-caption").each(function(){var b=a(this),c=b.text().trim().split(/[\s,!?:\-\|\n]+/)[0];c.length>31&&b.text(c.slice(0,29)+"...")}),d.find(".tile-caption, .tile-title").dotdotdot()),window.fluidWidgetCustomCallbacks.onCompleteAddingToDom(d),E(d,b)}function G(b,c,d,e,f,g,h,i,j){var k={page:f,ttl:g,filter_id:h,domain:i,tags_grouped_as:Nb,data_tags:Mb,search:j,geohash:Oa,tile_id:ya};return e?k.draft_id=e:d?k.wid=d:b+="/"+c,b+"?"+a.param(k)}function H(){Stackla.log("[inside] noMoreContentToLoad() is executed"),sa&&sa.hide(),bc=!0}function I(){var a;return a=Cb?(Db+1)*(Qb*Xa):(Db+1)*yb}function J(c){var e,f=I(),h=[],i=[],j=[],k=[];d(Ub,function(a,b){b<f&&(j.push(a),k.push(a._id.$id))}),Stackla.log("_resync contentShouldBeVisibleTileIds "+k),d(j,function(b){var c=b._id.$id;a("#"+c).length||(h.push(b),i.push(c))}),Stackla.log("_resync contentToAddTileIds "+i),g(h,i),la.find(".tile").each(function(){var c=a(this),d=c.attr("id");b(k,d)||la.isotope("remove",c)}),d(k,function(b){var c=la.find(".tile:last");e=a("#"+b),c.length&&e.length&&!c.is(e)&&c.after(e)}),c&&c()}function K(){var a=la.width();Qb=a<480?1:a<800?2:Math.ceil((a-Rb)/(Bb+Rb)),Pb.width=Math.floor(a/Qb-Rb);var b=window.fluidWidgetCustomCallbacks.onBeforeRenderIsotope(a,Bb,Rb,Qb,Pb.width);Qb=b.numColumns,Pb.width=b.tileWidth}function L(){Stackla.log("[inside] resizeTiles() is executed"),K(),la.find(".tile").each(function(){fb(a(this))}),la.isotope({masonry:{columnWidth:Pb.width+Rb,gutterWidth:0}}),la.isotope("reloadItems").isotope({sortBy:"original-order"}),ha("resize",{height:a("body").height()})}function M(b,c,d){var e={},f=r(c.source,c.message,p(c),c.media);if("undefined"!=typeof c.in_reply_to_message&&c.in_reply_to_message){var g=r(c.source,c.in_reply_to_message,q(c),c.media);c.in_reply_to_message=g}if(c.message=f,"undefined"!=typeof c.avatar){var h=t(c.avatar,c.source);c.avatar=h}if("undefined"!=typeof c.image){var i=u(c.image,c.source);c.image=i}if("undefined"!=typeof c.image_s){var j=u(c.image_s,c.source);c.image_s=j}c.html=ea(c.html),e.action="lightbox",e.data=c,e.options=za||{},e.widgetId=ta,e.tileId=b,e.widgetType="vertical",e.videoHtml=StacklaVideoPlayer.getEmbedCode("#tpl-video",a.extend({},c)),e.widgetSetting=Wa,e.widgetConfig=Wa,d&&(e.focusOn=d),e.lightboxCustomJs=Ga,e.lightboxCustomCss=Fa;var k=[];c.productsHtml="",k=_.filter(c.tags_extended,{type:"product"}),k=_.map(k,function(a){return a.cta_text=a.cta_text||"Buy Now",a}),k.length&&(c.productsHtml=Mustache.render(a("#tpl-product-list").html(),{products:k}));var l={like:{on:jb("up",c),count:c.numUps?c.numUps:""},dislike:{on:jb("down",c),count:c.numDowns?c.numDowns:""},vote:{on:jb("vote",c),count:c.numVotes?c.numVotes:""}};c.interactionData=l,c.allTagData=Ob,za.claimEnabled=w(c),za.claimActionUrl=A(c.source,c.source_user_id,c._id.$id),za.tile_show_votes=!(!za.show_votes||!stacklaSocialHub.actionVote(c)),ha("lightbox",e)}function N(){ya="",Lb="",zb=1,Db=0,Ub.length=0,Vb.length=0,Wb.length=0,ac=!1,bc=!1,la.isotope("remove",a(".tile"))}function O(){a(".button").css("visibility","hidden"),sa&&(sa.show(),sa.css("width","auto")),Za.show()}function P(){ya||a(".button").css("visibility","visible"),setTimeout(function(){Za.hide()},1e3),Sa=new Date}function Q(a){if(a.init_timestamp){var a,b=new Date(parseInt(a.init_timestamp,10));Sb.getDuration(b,Sa);la.imagesLoaded(function(){a={id:ta,initTime:b,benchmarks:{apiRequest:Ta,apiReceive:Ua,render:Sa,image:new Date},name:Ma,params:Ra,parentHost:a.parent_host,parentUrl:a.parent_url,stack:Hb,type:Na},Va.enable_track_widget_load_time&&Sb.track(a)})}}function R(a){N(),ya=a,O(),Cb?nb(function(){L(),P()}):bb(function(){L(),P()})}function S(b){var c,b=a.extend(!0,{},b),d=[];return b.products={},_.each(b.hotspots,function(a){c=!!_.find(d,function(b){return b==a.tag.id}),c&&(b.products[a.tag.id]=a.tag)}),b}function T(a,b,c){FluidWidgetCommon.buildExpandTileCallback(Ub,S,M,za)(a,c)}function U(b){a.get("/stackdotla/tile_shared?tile_id="+b+"&stack_id="+xa),a(document).trigger("tileShare",[{_id:b}])}function V(){if(!ac&&!bc&&cc){if("scroll"!==_a)return;ac=!0,ab.text(Qa.scroll_load),window.fluidWidgetCustomCallbacks.onScrollLoad(la.find(".tile"),ab),ab.animate({bottom:"+=100"},100),Db+=1;var a=Cb?nb:bb;a(function(){L(),setTimeout(function(){ac=!1,ha("moreLoad",{page:Db}),EventMixin.emit("moreLoad",[{page:Db,widgetId:ta,hasMore:!bc}]),bc?(ab.text(Qa.scroll_end),window.fluidWidgetCustomCallbacks.onScrollEnd(la.find(".tile"),ab),setTimeout(function(){ab.animate({bottom:"-=100"},500)},4e3)):ab.animate({bottom:"-=100"},500)},500)})}}function W(b){Stackla.log("safeContentReady() is executed.");var c=0;for(var d in dc)dc[d].safe_image===!0&&(c+=1);if(c>=yb){la.isotope("remove",a(".tile"));var e=0;for(var d in dc){if(e>yb)break;dc[d].safe_image===!0&&(F(dc[d],-1),e+=1)}L(),setTimeout(function(){b(e)},1e3)}else setTimeout(function(){W(b)},500)}function X(){Stackla.log("addSafeContent() is executed."),a.ajax({url:G(ma,ta,ua,va,fc,ra,wa,Aa,Lb),type:"GET",dataType:"json",success:function(b){if(hc)for(var c=b.length;c--;){var d=b[c];a.inArray(d._id.$id,Vb)===-1&&(Vb.push(d._id.$id),d.safe_image=!1,dc.splice(0,0,d),Z(d))}else for(var c in b){var d=b[c];a.inArray(d._id.$id,Vb)===-1&&(Vb.push(d._id.$id),d.safe_image=!1,dc.push(d),Z(d))}b.length<yb?(fc=1,gc=1e4,hc=!0):hc||(fc+=1),ic<yb&&setTimeout(function(){X()},gc)}})}function Y(b){var c=a(b).naturalWidth(),d=a(b).naturalHeight();if(c>30&&d>30){var e=a(b).attr("data-safe-content-id");for(var f in dc)dc[f]._id.$id===e&&(dc[f].safe_image=!0);for(var f in jc)jc[f]._id.$id===e&&(jc[f].safe_image=!0);a(b).attr({"data-audit-result":"ok","data-image-width":c,"data-image-height":d}),ic+=1}}function Z(b){if("undefined"!=typeof b.image){var c=a("<img />").attr({src:b.image,"data-safe-content-id":b._id.$id});c.imagesLoaded(function(){Y(c)}),Ba.append(c)}}function $(a){for(var b=jc.length;b--;)jc[b].safe_image===!0&&(F(jc[b],0),jc.splice(b,1));L(),setTimeout(function(){a()},1e3)}function aa(){a.ajax({url:G(ma,ta,ua,va,1,ra,wa,Aa,Lb),type:"GET",dataType:"json",success:function(b){if(b.length)for(var c in b){var d=b[c];a.inArray(d._id.$id,Vb)===-1&&(Vb.push(d._id.$id),d.safe_image=!1,jc.push(d),Z(d))}}})}function ba(a,b){"undefined"!=typeof b&&b?window.open(a,"_top"):window.open(a,"_blank")}function ca(a){return FluidWidgetCommon.getShareTextByTileId(a,Ub,za)}function da(a){return FluidWidgetCommon.getShareTitleByTileId(a,Ub,za)}function ea(b){if("undefined"!=typeof La&&La){var c="https://web-assets.stackla.com/app.stackla.com/media/js/brightcove/BrightcoveExperiences.js",d='<div class="stacklapopup-video-wrapper"> \t                <div class="stacklapopup-video-wrapper-inner"> \t                <div class="stacklapopup-video youtube" style="padding-top:{{paddingTop}}%"> \t                <div style="display:none"></div> \t                <script language="JavaScript" type="text/javascript" src="'+c+'"></script> \t                <object id="myExperience" class="BrightcoveExperience"> \t                    <param name="bgcolor" value="#FFFFFF" /> \t                    <param name="width" value="100%" /> \t                    <param name="height" value="360" /> \t                    <param name="playerID" value="3630509963001" /> \t                    <param name="playerKey" value="AQ~~,AAADTUgVWiE~,UqcbIDJjAYfynuLYO1eFaMb4W-Vpee7J" /> \t                    <param name="isVid" value="true" /> \t                    <param name="isUI" value="true" /> \t                    <param name="dynamicStreaming" value="true" /> \t                    <param name="secureConnections" value="true" /> \t                    <param name="secureHTMLConnections" value="true" /> \t                    <param name="autoStart" value="true" /> \t                    <param name="@videoPlayer" value="{{videoId}}" /> \t                </object> \t                <script type="text/javascript">setTimeout(function(){brightcove.createExperiences()},500)</script> \t                </div></div></div>',e=a("<div></div>").html(b?b:""),f="";return e.find("a[href*=videocloud]").each(function(){var b=a(this).attr("href"),c="undefined"!=typeof a(this).attr("data-width-ratio")&&a(this).attr("data-width-ratio")?parseInt(a(this).attr("data-width-ratio")):16,e="undefined"!=typeof a(this).attr("data-height-ratio")&&a(this).attr("data-height-ratio")?parseInt(a(this).attr("data-height-ratio")):9,g=Math.round(e/c*100),h=b.split(":");if(2===h.length){var i=h[1].trim(),j=Mustache.render(d,{videoId:i,paddingTop:g});f+=j}}),f+e.html()}return b}function fa(a){kc=a}function ga(a){lc=a}function ha(a,b){if(b=b||{},b.action=a,Stackla.log("[inside->outside] "+a),b.uniqueId=kc,b.widgetType=Jb,b.widgetId=ta,b.filterId=wa,b.hashId=ua,b.parentPagePermissions=null,b.shopspotsEnabled=Ia,b.layoutType=Ca,b.styleName=Da,b.appearance=Ea,Fb){var c=getUrlVars();b.parentPagePermissions={on:!0,userId:c.data_user_id?c.data_user_id:null,userHash:c.data_user_hash?c.data_user_hash:null,userName:c.data_user_name?c.data_user_name:null,parent_page_ext_username:Gb}}parent.postMessage(JSON.stringify(b),"*")}function ia(b){var c=a(b).closest(".tile")[0],d=a(c).attr("id");FluidWidgetCommon.invokeParentMethod(kc,"getSharingRedirectUrl",d).then(function(b){var e=b;wb(ta,e,d,function(b){var d=b.result.url;a.data(c,"short-url",d);var e=a(c).find(".tile-interaction-share");e.find(".tile-sharing-expanded").animate({opacity:"toggle"},200),e.toggleClass("on")})})}function ja(a){Oa=a,hb(wa,Mb,Nb)}function ka(){Db+=1;var a=Cb?nb:bb;a(function(){ha("moreLoad",{page:Db}),EventMixin.emit("moreLoad",[{page:Db,widgetId:ta,hasMore:!bc}]),L()})}var la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb=1,Ab=!1,Bb=320,Cb=!0,Db=0,Eb=!1,Fb=!1,Gb=!1,Hb="",Ib="",Jb="vertical",Kb=[],Lb="",Mb="",Nb="",Ob=[],Pb=[],Qb=5,Rb=0,Sb=Stackla.WidgetProfiling,Tb=!1,Ub=[],Vb=[],Wb=[],Xb=function(){var a=FluidWidgetCommon.buildLikeDislikeCallback();return function(b,c,d){return a(b,c,d,Ub,ta,ua,kb,jb)}}();gb=function(a,b){return b=b||"log",!(!window.console||!window.console[b])&&(window.console[b](a),!0)},lb=function(b,c){c=c||function(){};var d,e,f,g,h,i,j,k,l,p=a("#"+b).find(".tile-interaction-vote");if(p.hasClass("on"))return void o(b,"A vote has already been registered from this IP address.");for(l in Ub)if(Ub[l]._id.$id===b){i=Ub[l];break}for(var q in Kb)if(Kb[q]._id.$id===b){i=Kb[q];break}if(!i)return gb("No matched tile data.","warn"),!1;if(e=i.numVotes?parseInt(i.numVotes):0,d=jb("vote",i))return void o(b,"A vote has already been registered from this IP address.");if(k={vote:{on:p.hasClass("on"),count:e}},g="/widget/competition_vote/"+ta,h=["wid="+ua,"tile_id="+b,"addordelete=1"],Fb){if(f=getUrlVars(),!f.data_user_id||!f.data_user_hash)return void gb("Oops, an error occurred with the vote interaction: Invalid user ID and hash combination.","error");var r=z();r&&h.push(r)}j={vote:{on:!0,count:e+1}},n(b,!0,j.vote.count),c(j),m(b,"numVotes",e+1),a.ajax({url:g,type:"POST",data:h.join("&"),success:function(d){return d.success?(kb("vote",b,1),void a(document).trigger("tileVote",[{_id:b}])):(gb(d.error,"warn"),m(b,"numVotes",k.vote.count),n(b,!1,k.vote.count),k.vote.error=d.error,c(k),void o(b,d.error))},error:function(){m(b,"numVotes",k.vote.count),n(b,!1,k.vote.count)}})};var Yb=FluidWidgetCommon.buildAddInteractionToCookieCallback();kb=function(a,b,c){return Yb(a,b,c,Fb)};var Zb=FluidWidgetCommon.buildHasInteractionCallback();jb=function(a,b){return Zb(a,b,Fb)},db=function(b){var c=b.naturalWidth(),d=b.naturalHeight(),e=a(b).closest(".tile").attr("id");if(c>32&&d>32){var f,g,h,i;b.parent(".tile-image-wrapper").width()/b.parent(".tile-image-wrapper").height()!=1?(f=100,g=100,i=0,h=0):c<d?(f=100,g=Math.ceil(100*d/c),i=-1*Math.floor((g-100)/2),h=0):(f=Math.ceil(100*c/d),g=100,i=0,h=-1*Math.floor((f-100)/2)),a(b).css({width:f+"%",height:100===g?"auto":g+"%",marginLeft:h+"%",marginTop:i+"%"}),a(b).parent(".tile-image-wrapper").find(".tile-media-loading").hide(),"undefined"!=typeof a(b).attr("data-image-width")&&a(b).attr("data-image-width")&&"undefined"!=typeof a(b).attr("data-image-height")&&a(b).attr("data-image-height")||vb(e)||a.get("/cs/image",{_id:e,stack_id:xa,width:c,height:d,imageSize:a(b).attr("data-image-size")&&a(b).attr("data-image-size").length?a(b).attr("data-image-size"):"standard"})}else a.get("/cs/image/disable",{_id:e,stack_id:xa});window.fluidWidgetCustomCallbacks.onCompleteRenderImage(b)},vb=function(b){var c=a.cookie("csHistory")?a.cookie("csHistory"):"",d=c.split(",");return!!(a.inArray(b,d)+1)||(d.push(b),a.cookie("csHistory",d.join(","),{expires:7,path:"/"}),!1)},fb=function(b){var c,d,e=a(b),f=e.find(".tile-content"),g=e.find(".tile-image-wrapper"),h=g.find("img"),i=window.fluidWidgetCustomCallbacks.getTileWidth(b,Pb.width,Rb,Qb),j=i-parseInt(e.css("border-left")||0,10)-parseInt(e.css("border-right")||0,10)-parseInt(f.css("padding-left")||0,10)-parseInt(f.css("padding-right")||0,10)-parseInt(f.css("margin-left")||0,10)-parseInt(f.css("margin-right")||0,10),k=j;Stackla.log("[inside] calculateDimensions() is executed"),g.length&&h.length&&(c=h.attr("data-image-width"),d=h.attr("data-image-height"),"undefined"!=typeof c&&c&&"undefined"!=typeof d&&d&&(k=Math.round(j/(c/d)))),g.css("height",k+"px"),e.css("width",i+"px");var l=a(b).find(".tile-video-wrapper .vine-embed");l.length>0&&Math.abs(k-l.attr("width"))>150&&l.css("height",k+"px").attr("width",k).attr("height",k).attr("src",l.attr("src"));var m,n,o=a(b).find(".tile-html");o.length&&o.data("widthRatio")&&o.data("heightRatio")&&(m=o.data("widthRatio"),n=o.data("heightRatio"),o.css({width:j+"px",height:Math.round(j/(m/n))+"px"})),window.fluidWidgetCustomCallbacks.onCalculateDimensions(b)},rb=function(a){var b="//"+stacklaString(click_through_url.domain).escapeHTML().s,c=a.originalUrl,d=a._id.$id,e=b+"/c/"+d,f="";return"undefined"!=typeof click_through_url.ct&&(f=click_through_url.ct,"[NONE]"==f?f="":"[EXPAND]"==f?f="rss"!==a.source?"":/^[^\[]/.test(f)?f.replace("[EXPAND]",encodeURIComponent(c)):f.replace("[EXPAND]",c):/^[^\[]/.test(f)?(f=f.replace("[STACKLA_URL]",encodeURIComponent(b)),f=f.replace("[TILE_URL]",encodeURIComponent(e)),f=f.replace("[ORIGINAL_URL]",encodeURIComponent(c)),f=f.replace("[TILE_ID]",d)):(f=f.replace("[STACKLA_URL]",b),f=f.replace("[TILE_URL]",e),f=f.replace("[ORIGINAL_URL]",c)),"undefined"!=typeof a.enable_click_through&&a.enable_click_through&&(f=a.click_through)),f},qb=function(a){var b="";if("undefined"!=typeof click_through_url.ct){var c=click_through_url.ct;b="[NONE]"==c?"no-click-through":"[EXPAND]"==c?"rss"===a.source?"original-click-through":"expand-click-through":"[STACKLA_URL]"==c?"stack-click-through":"[TILE_URL]"==c?"tile-click-through":"[ORIGINAL_URL]"==c?"original-click-through":"custom-click-through","undefined"!=typeof a.enable_click_through&&a.enable_click_through&&(b="")}return b},mb=function(a,b){var c=!("undefined"==typeof b.anonymous||!b.anonymous),d=!("undefined"==typeof b.content_only||!b.content_only),e=!("undefined"!=typeof b.enable_ups&&!b.enable_ups),f=!("undefined"!=typeof b.enable_downs&&!b.enable_downs),g=!("undefined"!=typeof b.enable_comments&&!b.enable_comments),h=!(!c&&!d),i=!!d,j=!e,k=!f,l=!g;h&&(a.find(".tile-user-info").remove(),a.find(".tile-official-star").remove(),a.find(".tile-avatar-wrapper").remove(),a.find(".userHeader").remove()),i&&(a.find(".tile-belt").remove(),a.find(".tile-timestamp").remove(),a.find(".tile-tags").remove(),a.find(".tweetMeta").remove(),a.find(".expandedTileButtons hr:nth-child(2)").remove(),a.find(".lightboxComment").remove(),a.find(".lightboxComments").remove(),a.find(".expanded-tile-tags").remove(),a.find(".tile-interaction-share").remove(),a.find(".tile-interaction-vote").remove()),j&&a.find(".tile-interaction-like").remove(),k&&a.find(".tile-interaction-dislike").remove(),l&&(a.find(".tile-interaction-comment").remove(),a.find(".lightboxComment").remove(),a.find(".lightboxComments").remove()),a.find(".tile-interactions").html()||(a.find(".tile-interactions").remove(),a.removeClass("has-interactions"),a.find(".expandedTileButtons hr:nth-child(2)").remove())};var $b=FluidWidgetCommon.createInlineSharingButtonsGen2;eb=function(b){Tb||(Tb=!0,a.ajax({url:G(ma,ta,ua,va,1,ra,wa,Aa,Lb),type:"GET",dataType:"json",success:function(c){var d=0,e=[];if(c.length)for(var g=c.length;g--;)a.inArray(c[g]._id.$id,Vb)===-1&&(d+=1,e.push(c[g]));d&&(f(e,!1),J()),"undefined"!=typeof b&&b(),setTimeout(function(){Za.hide()},1e3),Tb=!1}}))},ib=function(){for(var b=1;b<zb;)a.ajax({url:G(ma,ta,ua,va,b,ra,wa,Aa,Lb),type:"GET",dataType:"json",success:function(a){for(var b in a){var c=a[b]._id.$id;for(var d in Ub)if(Ub[d]._id.$id==c&&a[b].numVotes&&!isNaN(parseInt(a[b].numVotes))){var e=la.find("#"+c+" .js-vote-count");if(e.length){var f=isNaN(parseInt(e.text()))?0:parseInt(e.text());parseInt(a[b].numVotes)>f&&(Ub[d].numVotes=a[b].numVotes,e.text(a[b].numVotes))}}}}}),b+=1},bb=function(b){if(!Tb)if(Tb=!0,e()){var c=G(ma,ta,ua,va,zb,ra,wa,Aa,Lb);a.ajax({url:c,type:"GET",dataType:"json",success:function(a){a.length?("undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",c]),zb+=1):H(),f(a,!0),J(function(){Tb=!1}),b&&b(),setTimeout(function(){Za.hide()},1e3)}})}else J(function(){Tb=!1,setTimeout(function(){Za.hide()},1e3)}),b&&b()},nb=function(b){Stackla.log("[inside] fluidRendering() is executed"),!Ab&&e()?(Ab=!0,Stackla.log("[inside] Content API call() starts"),a.ajax({url:G(ma,ta,ua,va,zb,ra,wa,Aa,Lb),type:"GET",dataType:"json",success:function(c){Stackla.log("[inside] Content API call() finishes"),Ab=!1,f(c,!0),c.length&&("undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",ma]),zb+=1),J(function(){!c.length&&Ub.length<=a(".container").find(".tile").length&&H(),b&&b()}),setTimeout(function(){Za.hide()},1e3)}})):J(function(){b&&b()})};var _b;a(window).resize(_.debounce(function(){_b!==a(window).width()&&(Stackla.log("[inside] resize"),_b=a(window).outerWidth(),K(),Cb?nb(function(){L()}):L())},500)),ob=function(){ha("initComplete",{name:Ma,filterId:wa,externalJs:Ib,lightboxCustomJs:Ga,lightboxCustomCss:Fa,options:za,style:{show_powered_by_stackla:xb,click_through_url:Ea.click_through_url}})},pb=function(a,b){if(a){var c=FluidWidgetCommon.buildInitCompleteCallback(qb,S,M,rb,ha,za,Ub,Kb,xa,ra);c(a)}else Q({embed_timestamp:b.embed_timestamp,init_timestamp:b.init_timestamp,parent_host:b.parent_host,parent_url:b.parent_url})},hb=function(a,b,c){var d=wa;N(),wa=a,Nb=c,Mb=b,O(),k(Cb?function(){nb(function(){window.fluidWidgetCustomCallbacks.onCompleteChangeFilter(wa,d),L(),P()})}:function(){bb(function(){window.fluidWidgetCustomCallbacks.onCompleteChangeFilter(wa,d),L(),P()})})},Pa=function(a){N(),Lb=a,O(),k(Cb?function(){nb(function(){L(),P()})}:function(){bb(function(){L(),P()})})},sb=function(b,c,d){a.ajax({url:"/widget/comments",type:"get",data:{stack_id:xa,tile_id:b,last_comment_id:c,how_many:d},success:function(a){ha("getCommentsCallback",{tileId:b,data:a})}})},tb=function(){return lc},ub=function(b,c,d,e){var f=z();f&&(f="?"+f),a.ajax({url:"/widget/save_comment/"+b+f,type:"post",data:{stack_id:xa,tile_id:c,username:d,comment:e},cache:!1,success:function(b){b&&b.success&&a(document).trigger("tileComment",[{_id:c}]),ha("postCommentCallback",{data:b,tileId:c})}})},wb=function(a,b,c,d){FluidWidgetCommon.getShortUrl(a,b,c,d,ha,za,Ub,xa)};var ac=!1,bc=!1,cc=!1,dc=[],ec=[],fc=1,gc=500,hc=!1,ic=0,jc=[];cb=function(b){Stackla.log("[inside] initialize start"),oa=b,ta=stacklaString(oa.widgetId).escapeHTML().s,ua=stacklaString(oa.hashId).escapeHTML().s,va=stacklaString(oa.draftId).escapeHTML().s,wa=stacklaString(oa.filterId).escapeHTML().s,xa=stacklaString(oa.stackId).escapeHTML().s,Ra=oa.requestParams,kc=oa.requestParams.unique_id,Ca=oa.options.layout,Da=oa.style,Ma=oa.name,Na=oa.widgetTypeName,Ea=oa.appearance,xb=oa.show_powered_by_stackla,ma=oa.api,Rb=oa.margin,Xa=oa.numRows,za=oa.options,Va=oa.stackConfig,Wa=oa._setting,$a=oa.inlineTileOptions,Aa=stacklaString(oa.alias).escapeHTML().s,Xa==-1&&(Cb=!1),Bb=oa.tileDimension.width,Pb={width:oa.tileDimension.width},pa="undefined"!=typeof oa.pollingFrequency&&oa.pollingFrequency,qa="undefined"!=typeof oa.autoRefresh&&oa.autoRefresh,ra=stacklaString(oa.ttl).escapeHTML().s,_a=oa.loadMoreType,yb=oa.itemPerPage,Fb=oa.parent_page_permissions,Gb=oa.parent_page_ext_username,Hb=oa.stackShortName,Ib=oa.externalJs,Fa=oa.lightboxCustomCss,Ga=oa.lightboxCustomJs,Ha=oa.stackEnabledClaim,Ia=oa.stackEnabledShopspots,Ja=oa.claimConfig,Ka=oa.imDomain,La=oa.enableBrightcoveVideoCloud,Lb=oa.requestParams&&oa.requestParams.search?oa.requestParams.search:"",Mb=oa.requestParams&&oa.requestParams.data_tags?oa.requestParams.data_tags:"",Oa=oa.requestParams&&oa.requestParams.geohash?oa.requestParams.geohash:"",Nb=oa.requestParams&&oa.requestParams.tags_grouped_as?oa.requestParams.tags_grouped_as:"",Qa=oa.strings,ya=oa.requestParams&&oa.requestParams.tile_id||"",window.stackId=xa,Widget.crossSiteAction("handShakeEstablished"),la=a("#container"),la.css({"padding-top":Rb+"px","padding-left":Rb+"px"}),la.isotope({itemSelector:".tile",animationEngine:"css"}),na=a(".track"),na.css({width:"100%"}),Ya=a("<div>").addClass("spinner"),Za=a("<div>").addClass("spinner-overlay"),Za.append(Ya),na.append(Za),K(),Eb="undefined"!=typeof window.multipleScreensSafeContent,Eb?(X(),setInterval(function(){aa()},1e4)):j(Cb?!0:!1),"scroll"===_a?(ab=a(".js-scroll-loading"),ab.text(Qa.scroll_load)):(sa=a(".js-load-more"),sa.text(Qa.load_more),sa.click(ka)),ya&&sa&&sa.hide(),qa&&setInterval(function(){la.find(".js-vote").length&&ib()},3e4),qa&&pa&&setInterval(function(){eb(function(){L()})},pa),Ba=a('<div class="image-audit" style="position: absolute; top: -9999px; left: -9999px; width: 0px; height: 0px"></div>'),a("body").append(Ba),a(document).trigger("load",[{id:ta}]),Stackla.log("[inside] initialize finish")};var kc,lc,mc={
initialize:cb,render:bb,addContent:eb,changeFilterCallback:hb,searchFilterCallback:Pa,initCompleteCallback:pb,expandedTile:T,allContentData:Ub,resizeTiles:L,getComments:sb,getCustomData:tb,postComment:ub,getShortUrl:wb,saveShareCount:U,scrollToPageBottom:V,pinnedData:Wb,safeContentReady:W,safeContentStorage:dc,safeContentTileIds:ec,newSafeContentReady:$,likeDislike:Xb,competitionVote:lb,openClaimedLightbox:B,parseMessage:r,setUniqueId:fa,setCustomData:ga,crossSiteAction:ha,expandInlineSharingTool:ia,changeGeohashCallback:ja,getPreviousTileIdByCurrentTileId:function(a){return FluidWidgetCommon.getPreviousTileIdByCurrentTileId(Ub,a)},getNextTileIdByCurrentTileId:function(a){return FluidWidgetCommon.getNextTileIdByCurrentTileId(Ub,a)},getUniqueId:function(){return kc},renderTiles:R,loadMore:ka};return FluidWidgetCommon.bindInlineShareFunctions(mc,ba,ca,da,U),_.assign(mc,EventMixin),mc}(jQuery);var d=_.defaults({scrollToPageBottom:function(a){a.scrollToPageBottom()}},FluidWidgetCommon.getWaterfallCarouselCommonCrossSiteHandlers());FluidWidgetCommon.bindCrossSiteHandler(Widget,d)}]);